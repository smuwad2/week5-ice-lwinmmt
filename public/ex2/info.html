<!DOCTYPE html>
<html>
    <head>

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        
         <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    </head>
    <body>
        <div class="bg-light text-center p-5 mb-4">
            <h2>Choose an option:</h2>
            <label for="limit">Limit:</label>
            <input id="limit" type="number" min=1 max=5 value=1 onchange="getData()">
            <select onchange="getData()" id="type">
                <option value="customers">Customers</option>
                <option value="products">Products</option>
                <option value="suppliers">Suppliers</option>
            </select>
            
        </div>
        <div id="result" class="container">

        </div>
        <script>
            function getData() {
                let limit = document.getElementById('limit').value;
                let type = document.getElementById('type').value;

                axios.get('/data', {
                    params: {
                        limit: limit,
                        type: type
                    }
                })
                .then(function(response) {
                    let data = response.data.records;
                    let resultDiv = document.getElementById('result');
                    
                    if (!data || data.length === 0) {
                        resultDiv.innerHTML = '';
                        return;
                    }

                    let headers = Object.keys(data[0]);
                    let title = type.charAt(0).toUpperCase() + type.slice(1);
                    
                    let tableHtml = `<h3>${title}</h3><table class="table"><thead><tr>`;
                    headers.forEach(header => {
                        tableHtml += `<th>${header}</th>`;
                    });
                    tableHtml += `</tr></thead><tbody>`;

                    data.forEach(row => {
                        tableHtml += `<tr>`;
                        headers.forEach(header => {
                            tableHtml += `<td>${row[header]}</td>`;
                        });
                        tableHtml += `</tr>`;
                    });

                    tableHtml += `</tbody></table>`;
                    resultDiv.innerHTML = tableHtml;
                })
                .catch(function(error) {
                    console.error("Error fetching data: ", error);
                    document.getElementById('result').innerHTML = `<p class="text-danger">Could not load data.</p>`;
                });
            }

            getData();
        </script>
</body>
</html>